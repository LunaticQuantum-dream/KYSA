Name:KYSA-202204-1063
Severity:低等
Summary:php安全漏洞
Published:2022-04-26
URL:/support/loophole/patch/1092.html
Title:
			公告ID：KYSA-202204-1063
公告摘要：php安全漏洞
安全等级：Low
发布日期：2022年04月26日
影响CVE：CVE-2013-6420、CVE-2014-3515、CVE-2014-3669、CVE-2014-8142、CVE-2014-9705、CVE-2015-0231、CVE-2015-0273、CVE-2015-2301、CVE-2015-2787、CVE-2015-3307、CVE-2015-3329、CVE-2015-3329、CVE-2015-4025、CVE-2015-4026、CVE-2015-4147、CVE-2015-4599、CVE-2015-4600、CVE-2015-4601、CVE-2015-4602、CVE-2015-4603、CVE-2015-4604、CVE-2015-4605、CVE-2015-4643、CVE-2016-5766、CVE-2016-5768
		
1. 修复的CVE·CVE-2013-6420描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP中的ext/openssl/openssl.c文件中的‘asn1_time_to_time_t’函数中存在内存损坏漏洞，该漏洞源于openssl_x509_parse()函数没有正确解析X.509证书中的notBefore和notAfter时间戳。远程攻击者可借助特制的证书利用该漏洞执行任意代码或造成拒绝服务（应用程序崩溃）。·CVE-2014-3515描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。SPL（Standard PHP Library，PHP标准库）是其中的一个用于解决典型问题（standard problems）的接口与类的集合组件。PHP 的SPL组件存在类型混淆漏洞。远程攻击者可借助特制的字符串利用该漏洞执行任意代码。·CVE-2014-3669描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/standard/var_unserializer.c脚本中‘object_custom’函数存在整数溢出漏洞。远程攻击者可通过向‘unserialize’函数传递特制的参数利用该漏洞造成拒绝服务（应用程序崩溃）或执行任意代码。·CVE-2014-8142描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/standard/var_unserializer.re文件中的‘process_nested_data’函数中存在释放后重用漏洞。远程攻击者可借助特制的非序列化调用利用该漏洞执行任意代码。·CVE-2014-9705描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/enchant/enchant.c文件中的‘enchant_broker_request_dict’函数中存在基于堆的缓冲区溢出漏洞。远程攻击者可通过创建多个词库利用该漏洞执行任意代码。·CVE-2015-0231描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/standard/var_unserializer.re文件中的‘process_nested_data’函数存在释放后重用漏洞。远程攻击者可借助特制的反序列化的调用利用该漏洞执行任意代码。·CVE-2015-0273描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/date/php_date.c文件中存在释放后重用漏洞，该漏洞源于‘php_date_timezone_initialize_from_hash’函数没有充分过滤‘DateTimeZone’数据；‘php_date_initialize_from_hash’函数没有充分过滤‘DateTime’数据。远程攻击者可借助带有‘R’或‘r’类型说明符的特制的序列化输入利用该漏洞执行任意代码。·CVE-2015-2301描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP 的phar_object.c文件中的‘phar_rename_archive’函数存在释放后重用漏洞。远程攻击者可利用该漏洞造成拒绝服务。·CVE-2015-2787描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/standard/var_unserializer.re文件中的‘process_nested_data’函数存在释放后重用漏洞。远程攻击者可利用该漏洞执行任意代码。·CVE-2015-3307描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/phar/phar.c文件中的‘phar_parse_metadata’函数存在安全漏洞。远程攻击者可借助特制的tar归档利用该漏洞造成拒绝服务（堆元数据损坏）。·CVE-2015-3329描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的phar_internal.h文件中的‘phar_set_inode’函数存在基于栈的缓冲区溢出漏洞。远程攻击者可借助tar、phar或ZIP归档中特制的长度值利用该漏洞执行任意代码。·CVE-2015-4022描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/ftp/ftp.c文件中的‘ftp_genlist’函数存在整数溢出漏洞。远程攻击者可借助LIST命令的超长的回复利用该漏洞执行任意代码。·CVE-2015-4025描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP中存在安全漏洞，该漏洞源于程序遇到‘x00’字节时截断路径名。远程攻击者可借助多个函数（set_include_path，tempnam，rmdir，readlink）中特制的参数利用该漏洞绕过既定的扩展限制，获取文件或目录的访问权限。·CVE-2015-4026描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的pcntl_exec实现过程中存在安全漏洞，该漏洞源于程序不允许路径名中存在空字节。远程攻击者可借助特制的‘first’参数利用该漏洞绕过既定的扩展限制，执行文件。·CVE-2015-4147描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/soap/soap.c文件中的‘SoapClient：：__call’方法中存在安全漏洞，该漏洞源于程序没有验证数组中的‘__default_headers’值。远程攻击者可通过提供特制的序列化数据利用该漏洞执行任意代码。·CVE-2015-4599描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/soap/soap.c文件中的‘SoapFault：：__toString’方法存在安全漏洞。远程攻击者可借助数据类型利用该漏洞获取敏感信息，造成拒绝服务（应用程序崩溃），或执行任意代码。·CVE-2015-4600描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的SoapClient实现过程中存在安全漏洞。远程攻击者可借助数据类型利用该漏洞造成拒绝服务（应用程序崩溃）或执行任意代码。·CVE-2015-4601描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP 版本中存在安全漏洞。远程攻击者可借助数据类型利用该漏洞造成拒绝服务（应用程序崩溃）或执行任意代码。·CVE-2015-4602描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/standard/incomplete_class.c文件中的‘__PHP_Incomplete_Class’函数中存在安全漏洞。远程攻击者可借助数据类型利用该漏洞造成拒绝服务（应用程序崩溃）或执行任意代码·CVE-2015-4603描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的Zend/zend_exceptions.c文件中的‘exception：：getTraceAsString’函数存在安全漏洞。远程攻击者可借助数据类型利用该漏洞执行任意代码。·CVE-2015-4604描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言；Fileinfo是其中的一个用于显示文件属性并支持批量修改其属性的组件。file是软件开发者Christos Zoulas所负责维护的一套用于类Unix系统下查看文件格式的工具。PHP的Fileinfo组件中使用的file中的softmagic.c文件中的‘mget’函数存在安全漏洞，该漏洞源于程序没有正确位置特定的指针关系。远程攻击者可借助‘Python script text executable’规则未正确处理的字符串利用该漏洞成拒绝服务（应用程序崩溃）或执行任意代码。·CVE-2015-4605描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言；Fileinfo是其中的一个用于显示文件属性并支持批量修改其属性的组件。file是软件开发者Christos Zoulas所负责维护的一套用于类Unix系统下查看文件格式的工具。PHP的Fileinfo组件中使用的file中的softmagic.c文件中的‘mcopy’函数存在安全漏洞，该漏洞源于程序没有正确限制特定的偏移值。远程攻击者可借助‘Python script text executable’规则未正确处理的字符串利用该漏洞成拒绝服务（应用程序崩溃）或执行任意代码。·CVE-2015-4643描述：PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。PHP的ext/ftp/ftp.c文件中的‘ftp_genlist’函数中存在整数溢出漏洞。远程攻击者可借助LIST命令较长的应答利用该漏洞执行任意代码。·CVE-2016-5766描述：在PHP的gd扩展的imagecreatefromgd2（）函数中发现一个整数溢出缺陷，导致基于堆的缓冲区溢出。远程攻击者可以利用此漏洞使PHP应用程序崩溃，或以运行该PHP应用程序的用户的权限通过巧尽心思构建的GD2映像执行任意代码。·CVE-2016-5768描述：在用于执行regex搜索的php的mb_ereg_replace_callback（）函数中发现了一个双自由漏洞。此缺陷可能导致PHP应用程序崩溃。2. 受影响的软件包·银河麒麟高级服务器操作系统 V10mips64el架构:php、php-bcmath、php-cli、php-common、php-gd、php-mbstring、php-mysql、php-pdo、php-process、php-xml3. 软件包修复版本·银河麒麟高级服务器操作系统 V10php-5.4.16-42.ns7_4.2php-bcmath-5.4.16-42.ns7_4.2php-cli-5.4.16-42.ns7_4.2php-common-5.4.16-42.ns7_4.2php-gd-5.4.16-42.ns7_4.2php-mbstring-5.4.16-42.ns7_4.2php-mysql-5.4.16-42.ns7_4.2php-pdo-5.4.16-42.ns7_4.2php-process-5.4.16-42.ns7_4.2php-xml-5.4.16-42.ns7_4.24. 修复方法方法一：配置源进行升级安装1. 打开软件包源配置文件，根据仓库地址进行修改。仓库源地址： 银河麒麟高级服务器操作系统 V10mips64el:http://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/2. 配置完成后执行更新命令进行升级，命令如下：yum update Packagename方法二：下载安装包进行升级安装通过软件包地址下载软件包，使用软件包升级命令根据受影响的软件包列表进行升级安装,命令如下：yum install Packagename3. 升级完成后是否需要重启服务或操作系统：·CVE-2013-6420：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2014-3515：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2014-3669：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2014-8142：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2014-9705：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-0231：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-0273：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-2301：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-2787：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-3307：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-3329：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4022：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4025：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4026：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4147：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4599：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4600：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4601：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4602：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4603：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4604：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4605：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2015-4643：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2016-5766：无需重启操作系统与服务即可使漏洞修复生效。·CVE-2016-5768：无需重启操作系统与服务即可使漏洞修复生效。5. 软件包下载地址·银河麒麟高级服务器操作系统 V10 php（mips64el）软件包下载地址:http://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-bcmath-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-cli-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-common-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-gd-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-mbstring-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-mysql-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-pdo-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-process-5.4.16-42.ns7_4.2.mips64el.rpmhttp://download.cs2c.com.cn/neokylin/server/releases/v10/ls_64/Packages/php-xml-5.4.16-42.ns7_4.2.mips64el.rpm 注：其他相关依赖包请到相同目录下载6. 修复验证使用软件包查询命令，查看相关软件包版本是否与修复版本一致，如果版本一致，则说明修复成功。sudo rpm -qa | grep Packagename
